-네트워크는 다수의 IoT 디바이스와 게이트 웨이, 그리고 단일 기지국으로 구성됨
-IoT 장치는 게이트웨이 장치를 통해 데이터를 전송합니다. 게이트웨이는 계산 장치입니다. IoT 장치와 기타 사용 가능한 게이트웨이를 연결합니다.
게이트웨이 장치는 라우팅 테이블을 유지 관리합니다. 네트워크에서 모든 게이트웨이는 서로 연결되어 네트워크 전체에 걸쳐 장치 간에 경로를 제공합니다.
IoT 장치가 데이터를 전송해야 한다고 가정하면 먼저 링크 설정을 위해 게이트웨이 장치에 요청을 보내야 합니다. 
게이트웨이의 라우팅 테이블에 경로가 있으면 대상 장치에 대한 링크에서 다음 게이트웨이 장치를 언급합니다. 그렇지 않으면 게이트웨이가 효율적인 
경로를 찾아야 합니다. 이를 위해 게이트웨이 장치는 연결된 다른 모든 게이트웨이에 RRM을 브로드캐스트합니다. 
인접 게이트웨이 장치가 목적지(일반적으로 기지국)에 대한 경로 정보를 가지고 있으면 소스 게이트웨이 장치에 경로 정보 메시지(RIM)를 다시 보냅니다.
그렇지 않으면 RRM을 더 연결된 게이트웨이로 전달합니다.

*INTI*

-사물 인터넷(IoT) 네트워크는 다양한 공격에 취약하며 싱크홀 공격은 네트워크 장치 간의 통신을 차단하므로 가장 파괴적인 공격 중 하나입니다.
싱크홀 공격자는 수집 지점의 데이터 수신에 피해를 주는 지정된 영역에서 가장 많은 양의 트래픽을 유인하는 것을 목표로 합니다. 
따라서 장치(노드)에서 보낸 데이터의 신뢰성과 무결성이 손상됩니다. 
-침입 탐지 시스템(IDS)은 컴퓨터 네트워크에 대한 공격 및 위협에 대한 안전성을 향상시킵니다. 일부 제안은 공격 노드[10]의 
로컬 탐지를 위해 감시 전략을 사용하여 인접 노드에서 전송된 패킷을 듣고 분석할 수 있습니다. 
-INTI는 라우팅에서 공격 싱크홀의 영향을 방지, 감지 및 격리하는 동시에 역효과를 완화하는 것을 목표로 합니다. 
각 노드의 행동을 분석하여 공격자 탐지를 위한 감시, 평판 및 신뢰 전략을 결합합니다.
-[8]에서 저자들은 싱크홀, 선택적 포워딩, 시빌 등 다양한 공격에 대처하는 IDS인 SVELTE를 제시한다. 중앙 집중식 시스템은 
매핑(6Mapper), 침입 탐지 및 라우팅 공격에 대한 미니 방화벽의 세 가지 모듈을 정의합니다. 또한 SVELTE 및 Ebbits는 리소스 소비가 
많아 네트워크 및 시스템 성능이 저하됩니다. 
-통신 모델은 물리적 네트워크 노드 간의 클러스터 및 클러스터 간 내 통신의 두 가지 수준으로 구성됩니다. 첫 번째는 여러 클러스터에 
설정된 통신에 해당하고 두 번째는 클러스터의 형성을 포함합니다. 이 통신 모델은 장치의 이동성과 데이터 라우팅도 고려합니다.
물리적 네트워크 모델: 
=>물리적 네트워크는 {n1, n2, n3, ..., ni}로 식별되는 n개의 디바이스(노드)의 집합 P에 해당하며, 여기서 ni는 집합 P의 원소이다.
=>각 노드 ni에는 ID(식별)를 결정하는 고유한 물리적 주소가 있습니다. 
=>전송 노드는 비동기 채널을 사용하는 무선 매체를 통해 발생하며 노이즈 및 노드 이동성으로 인한 패킷 손실이 발생합니다.
=>노드는 메모리 크기 및 배터리와 같은 다양한 리소스로 구성됩니다. 
=>또한 모든 노드는 동일한 전송 범위를 가지며 서로 다른 방향으로 이동할 수 있으며 가상으로 클러스터로 배열됩니다.
=>네트워크 장치는 자유 노드, 클러스터 구성원 노드, 관련 노드, 리더 노드 및 기지국으로 분류됩니다.
=>자유 노드는 클러스터에 속하지 않으며 네트워크 영역 내에서 이동할 수 있습니다. 
=>구성원 노드는 클러스터에 속하며 시간 간격으로 리더 노드에 정보를 보냅니다. 
=>리더 노드는 멤버 노드 및 관련 노드로부터 정보를 수신하여 기지국으로 전송합니다. 
=>연결된 노드는 데이터 라우팅 및 서로 다른 클러스터 간의 연결을 용이하게 하기 위해 클러스터 간에 정보를 전달합니다.
=>기지국은 수집된 모든 데이터를 수신합니다.
통신 모델:
=>장치 통신 모델은 IoT 장치의 리소스 제한을 존중하는 RPL 프로토콜(저전력 및 손실 네트워크용 IPv6 라우팅 프로토콜)을 사용합니다.
=>그러나 RPL은 정적 장치 및 환경에서만 작동하기 때문에 [4] 장치 이동성과 클러스터 형성을 모두 고려하는 RPL에서 영감을 얻은 
새로운 라우팅 프로토콜이 개발되었습니다.
공격 모델:
=>각 노드가 데이터 패킷 전송 및 전달을 담당하므로 싱크홀 노드는 주어진 시간에 리더, 관련 또는 구성원 노드로 공격을 시도할 수 
있습니다.
=>싱크홀 공격은 무선 네트워크의 모든 라우팅 공격 중 가장 파괴적인 것으로 간주됩니다[5]. 
=>이러한 유형의 공격에서 공격자는 원하는 목적지까지의 최단 경로를 알고 있음을 이웃에게 알립니다. 
=>특정 지역의 트래픽을 끌어들여 패킷을 폐기하고 네트워크 통신을 손상시키는 것을 목표로 합니다.

-INTI 시스템은 장치의 이동성을 고려하며 공격자가 네트워크에서 자유 노드, 구성원 노드, 리더 노드와 같은 다양한 역할을 수행할 수 
있습니다. 네트워크에서 자체 구성 및 자체 수리 속성을 제공합니다. 
-첫 번째 속성은 네트워크 구성에 대한 장치의 조정 및 협력을 목표로 합니다. 두 번째 속성은 네트워크 안정성을 유지하기 위해 의심스러운 
노드 및 클러스터 재그룹화를 감지할 수 있습니다. 

-Configuration of clusters
-이 모듈은 확장성을 보장하고 네트워크의 수명을 연장하기 위해 노드 클러스터링을 설정하는 리더 기반 계층을 정의합니다.
노드는 네트워크 기능에 따라 구성원, 연관 및 리더로 분류됩니다.각 노드의 역할은 노드 이동성 또는 공격 이벤트로 인한 네트워크 
재구성으로 인해 시간이 지남에 따라 변경될 수 있습니다.
-처음에는 네트워크의 모든 노드가 자유 노드로 작동하여 제어 데이터를 수집하고 전송합니다. 노드는 브로드캐스트를 통해 데이터를 
전송하여 제어 메시지 교환을 설정합니다. 이 메시지를 통해 노드는 리더를 선출하기 위해 이웃 노드의 양을 추정할 수 있습니다.
자유 노드는 다른 노드에 비해 이웃 노드가 가장 많을 때 리더 후보로 분류됩니다. 리더 선출 후 클러스터링이 정의됩니다.
이 단계에서 리더는 클러스터를 구성하기 위해 리더 중 한 명과 합류하기 위한 이웃(자유 노드)의 결정을 기다립니다.
클러스터가 설정되면 리더는 클러스터 노드(구성원 노드) 중 하나가 다른 리더로부터 둘 이상의 메시지를 수신했는지 확인합니다. 
구성원 노드가 둘 이상의 메시지를 수신하는 경우 이 노드는 클러스터를 상호 연결할 수 있는 연관된 노드가 됩니다. 
동일한 영역 내에 두 개의 구성원 노드가 있는 경우 가장 높은 에너지 함량(IE)을 가진 노드를 연결된 노드로 간주합니다. 
여기서 TERi는 동일한 노드에서 남은 총 에너지를 나타내고 TEci는 해당 노드ni에서 소비하는 총 에너지입니다.
-INTI는 Beta Probability Density Function을 적용하여 노드의 이전 결과를 기반으로 미래의 행동 가능성을 예측한다, 그리고 
각 노드 동작의 상태를 추정합니다. 추가적으로 beta parameter는 노드의 행동 결정을 지속적으로 업데이트 한다.
변수 상태(St)는 노드 동작을 저장하여 메시지 전송에서 노드의 작동 모드를 결정합니다. 
-클러스터 재구성은 노드가 실패하거나 클러스터를 떠날 때 또는 싱크홀 공격이 발생할 때 발생합니다. 리더 노드가 
이러한 문제 중 하나의 영향을 받는 경우 두 가지 작업이 발생할 수 있습니다. 클러스터에 새 리더를 선택하거나 영향을 받는 
구성원 노드가 인접 클러스터에서 재그룹화됩니다. 연관 노드가 영향을 받는 경우, 다른 구성원 노드는 공통 영역 내에 있으므로 
연관 노드로 선택할 수 있습니다. 그렇지 않고 두 클러스터 리더가 동일한 전송 반경 내에 있는 경우 각 그룹이 가진 가장 많은 
구성원 노드 수를 고려하여 클러스터의 융합이 발생합니다. 이는 리더의 수를 최소화하는 것을 목표로 합니다.

-Monitoring Node
-INTI는 메시지 전달을 담당하는 노드가 수행하는 입출력의 전송 횟수를 계산하는 모니터링 모듈을 정의합니다. 이를 위해 "관찰자" 노드는 
메시지 전달을 담당하는 "상위" 노드가 수행한 전송 횟수를 모니터링합니다.
그런 다음 수행된 전송 입력 및 출력의 양을 추정합니다. 들어오는 스트림의 양이 출력 스트림의 수와 같으면 노드가 양호합니다. 
그렇지 않으면 정상 작동에서 편차가 발생하는 것으로 가정합니다. 그림 3은 다른 클러스터에서 모니터링 및 데이터 라우팅 작업을 보여줍니다. 

-Detection of the attacker
-INTI는 싱크홀 공격 노드의 신원을 식별하고 공개합니다. 공격자 탐지 모듈은 두 가지 평가를 수행합니다. 
이러한 평가는 싱크홀 공격을 탐지하기 위해 노드의 평판과 신뢰를 추정합니다. 이러한 평가는 노드의 보안과 무결성을 지속적으로 
유지합니다.
-평판은 노드가 반복, 작업 또는 정보 교환을 통해 설정하는 믿음 또는 인식입니다. 모니터링 작업을 기반으로 하는 이러한 반복은 
클러스터 내부와 같은 직접적인 방법으로 수행되거나 두 클러스터 사이의 간접적인 방법으로 수행됩니다[14].
-베타 분포의 사용은 노드의 평판과 신뢰에 필수적입니다. 이 분포의 장점은 매개변수가 지속적으로 업데이트된다는 것입니다. 
INTI 시스템은 노드 평판을 나타내기 위해 베타 분포를 사용하여 불확실성(u), 믿음(b) 및 불신(d)의 세 가지 예측을 계산합니다.
-얻은 예측(u, b, d)을 계산한 후 노드 평판을 얻을 수 있습니다. 이 값은 구성원 노드가 리더에게 보낸 상태를 기반으로 자체적으로 
계산된 자체 통신 반복 및 예측을 고려합니다. 따라서 각 노드는 평판 계산을 위한 메시지 전송에서 동작에 대한 상태(St)를 전파합니다.
이 값은 감지 확률을 높이고 오경보를 줄이기 위해 이론 Dempster-Shafer를 적용하기 위해 감지 모듈에서 사용하는 입력 데이터입니다.
평판은 한계 P[0,1] 내에서 연속적인 값이며, 평판 값이 0.5보다 크거나 같으면 노드는 "양호"로 간주됩니다. 그렇지 않으면 공격자로 간주됩니다.
다음 단계는 Confidence(C)의 계산입니다. 그것은 엔터티가 다른 엔터티에 대해 갖는 정직 관계로 구성됩니다.
이 값의 범위는 [0,1]이고 평균 값은 0,5입니다. 신뢰도 값이 0.5보다 크면 노드가 양호합니다. 그렇지 않으면 노드가 공격자입니다.

-Isolation of Attacker
-그림 4(a)는 연관 노드 역할을 하는 노드 n5가 싱크홀 공격자 노드로 변하는 것을 보여줍니다. 따라서 클러스터 노드의 라우팅 메시지에 영향을 줍니다.
이 그림은 또한 네트워크에서 이동성으로 인해 다른 기능을 수행하는 노드를 보여줍니다. 그림 4(b)는 n14가 공격자를 탐지하는 방법을 보여주고 
있으며, n14는 공격자의 신원을 공개하고 공격자를 격리하고 클러스터 간 통신의 안정성을 유지하기 위해 클러스터 재구성 메시지를 
전달합니다. 
-이 모듈은 감지 후 싱크홀 노드를 격리합니다. 이를 위해 싱크홀 공격을 감지한 노드는 주변 노드들에게 경고할 목적으로 방송 중 
경보 메시지를 생성하여 전파한다. 또한, 이 노드는 이웃에게 복구 메시지를 전송하여 공격자의 격리를 촉진합니다. 
-싱크홀을 분리하는 방법에는 세 가지가 있습니다. 
-(i) 싱크홀 노드가 구성원 노드인 경우: 자체 리더가 해당 노드를 격리합니다.
-(ii) 싱크홀 노드가 리더 역할을 할 때; 이 경우 구성원 노드는 싱크홀 노드를 격리하거나 연결된 노드가 있는 경우 공격자를 격리합니다.
-(iii) 싱크홀 노드가 연관 노드 역할을 하면 순위가 가장 높은 리더 노드에 의해 격리되어 공격자와의 통신이 차단됩니다.
-메시지를 목적지 노드로 전달할 수 있도록 클러스터 내에 가장 낮은 순위의 연결된 다른 노드가 있는지 확인하는 것도 중요합니다. 
그렇지 않으면 리더는 이웃 클러스터에 합류하기 위해 구성원에게 복원 메시지를 전파합니다. 














































